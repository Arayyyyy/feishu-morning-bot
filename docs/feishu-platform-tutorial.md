# 飞书集成平台部署教程

## 📱 什么是飞书集成平台？

飞书集成平台是飞书官方提供的低代码开发平台，可以直接在飞书内创建自动化应用，无需外部服务器。

## 🎯 两种方案对比

| 方案 | 优点 | 缺点 | 推荐度 |
|------|------|------|--------|
| **飞书自动化** | 简单易用，无需代码，免费 | 功能有限，无法抓取外部RSS | ⭐⭐⭐ |
| **飞书集成平台 - 多维表格** | 内置定时触发，支持HTTP请求 | 需要一定配置 | ⭐⭐⭐⭐ |
| **自建机器人 (Node.js)** | 功能强大，完全可控 | 需要服务器 | ⭐⭐⭐⭐⭐ |

---

## 方案一：飞书自动化（最简单）

### 适用场景
- 无需定时，只需手动转发内容
- 接收Webhook推送的内容

### 配置步骤

#### 1. 创建自动化

1. 打开飞书，进入任意群聊
2. 点击群设置 → **自动化**
3. 点击 **+ 创建自动化**

#### 2. 配置触发器

选择 **"当收到消息时"** 或 **"按计划"**

#### 3. 配置操作

- 发送消息到群聊

### 局限性
- ❌ 无法直接抓取外部RSS（需要通过Webhook中转）
- ❌ 定时功能有限

---

## 方案二：飞书集成平台 + 多维表格（推荐）

### 适用场景
- 需要定时任务
- 需要存储数据
- 无需外部服务器

### 配置步骤

#### 步骤1：创建多维表格应用

1. 打开飞书，创建一个新的**多维表格**
2. 命名为"早报内容库"

#### 步骤2：设计数据表

创建以下列：

| 列名 | 类型 | 说明 |
|------|------|------|
| 标题 | 文本 | 文章标题 |
| 链接 | URL | 文章链接 |
| 来源 | 文本 | 公众号/网站名称 |
| 发布时间 | 日期 | 发布时间 |
| 是否已发送 | 复选框 | 是否已发送到群聊 |

#### 步骤3：创建自动化流程

1. 点击右上角 **自动化** 按钮
2. 创建新的自动化

#### 步骤4：配置定时触发

**触发器**：选择 **"按计划运行"**

配置：
```
频率：每天
时间：08:00
```

#### 步骤5：添加HTTP请求

由于飞书自动化无法直接抓取RSS，需要一个中转服务。

**选项A**：使用现有的RSS转Webhook服务
- **Feedspush**：https://feedspush.com/
- **Blogtrottr**：https://blogtrottr.com/

**选项B**：使用我们的Node.js服务作为后端

---

## 方案三：混合方案（最灵活）

### 架构

```
┌─────────────────────────────────────────────────┐
│              飞书群聊                            │
└──────────────────┬──────────────────────────────┘
                   │
                   │ 接收消息
                   ▼
┌─────────────────────────────────────────────────┐
│          飞书机器人 (我们的Node.js项目)          │
│  - 抓取RSS                                       │
│  - 定时发送                                       │
│  - 部署在: Railway/Render/云服务器               │
└─────────────────────────────────────────────────┘
```

### 部署到 Railway（推荐）

#### 步骤1：准备项目文件

创建 `Procfile`：
```
web: npm start
```

#### 步骤2：创建 Railway 账号

1. 访问 https://railway.app/
2. 用 GitHub 登录
3. 点击 **New Project**

#### 步骤3：部署项目

1. 选择 **Deploy from GitHub repo**
2. 选择您的项目仓库
3. Railway 会自动检测 Node.js 项目
4. 配置环境变量：
   ```
   FEISHU_APP_ID=cli_a832b8e55563101c
   FEISHU_APP_SECRET=Vfyy6v9lu78j8O0GnrjpLdTXzLDgdlUl
   PORT=3000
   MORNING_BRIEF_SCHEDULE=0 8 * * *
   ```
5. 点击 **Deploy**

#### 步骤4：获取公网地址

部署完成后，Railway 会提供一个公网地址，如：
```
https://your-app.railway.app
```

#### 步骤5：测试

```bash
curl -X POST https://your-app.railway.app/api/trigger
```

---

## 方案四：使用飞书小程序（进阶）

如果需要完全在飞书内运行：

### 步骤1：创建飞书小程序

1. 访问 https://open.feishu.cn/
2. 创建 **企业自建应用**
3. 选择 **小程序** 类型

### 步骤2：开发后端服务

使用飞书云函数或自建后端

### 步骤3：配置定时任务

使用飞书的 **定时触发器** 功能

---

## 💡 推荐方案总结

| 需求 | 推荐方案 |
|------|----------|
| **最简单，免费，无需代码** | 飞书自动化 + RSS转Webhook服务 |
| **免费，有服务器** | Railway/Render 部署 Node.js 项目 |
| **企业使用，稳定可靠** | 阿里云/腾讯云 + PM2 |
| **完全在飞书内** | 飞书小程序 + 云函数 |

---

## 🚀 快速开始（推荐）

如果您想快速免费部署，推荐使用 **Railway**：

### 1. 安装 Railway CLI

```bash
npm install -g railway
```

### 2. 登录

```bash
railway login
```

### 3. 初始化项目

```bash
cd feishu-morning-bot
railway init
```

### 4. 添加环境变量

```bash
railway variables set FEISHU_APP_ID=cli_a832b8e55563101c
railway variables set FEISHU_APP_SECRET=Vfyy6v9lu78j8O0GnrjpLdTXzLDgdlUl
railway variables set PORT=3000
railway variables set MORNING_BRIEF_SCHEDULE="0 8 * * *"
```

### 5. 部署

```bash
railway up
```

### 6. 查看日志

```bash
railway logs
```

---

## 📞 需要帮助？

请告诉我您想使用哪种方案，我可以提供详细的配置指导！
